<!DOCTYPE html>
<html lang="en">

<head>
    <title>RMSI CSV Generator</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="minimum-scale=1, initial-scale=1, width=device-width" />

    <script src="https://unpkg.com/react@17/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@material-ui/core@latest/umd/material-ui.production.min.js"
        crossorigin="anonymous"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/papaparse@5.3.0/papaparse.min.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <style>
        a:link {
            color: #556cd6;
        }

        /* visited link */
        a:visited {
            color: #556cd6;
        }

        /* mouse over link */
        a:hover {
            color: #5657D6;
            font-weight: bold;
        }

        /* selected link */
        a:active {
            color: #556cd6;
        }

        .skadjhak {
            left: 0;
            right: 0;
            bottom: 0;
            content: "";
            position: absolute;
            transform: scaleX(0);
            transition: transform 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;
            border-bottom: 2px solid #556cd6;
            pointer-events: none;
        }

        .MuiInput-underline {
            border-bottom: 0px solid white;
        }

        .MuiInput-underline:before {
            border-bottom: 1px solid white;
        }

        .MuiInput-underline:before {
            border-bottom: 1px solid white;
        }

        .MuiInput-underline:after {
            border-bottom: 1px solid white;

        }
    </style>
</head>

<body>
    <div id="root"></div>
    <script type="text/babel">

        /* ----- BEGIN: MUI Setup ----- */
        //Import MUI components
        const {
            Box,
            Button,
            Checkbox,
            Chip,
            colors,
            Container,
            createMuiTheme,
            CssBaseline,
            DraftsIcon,
            FormControl,
            FormControlLabel,
            FormHelperText,
            Grid,
            Icon,
            Input,
            InputLabel,
            Link,
            List,
            ListItem,
            ListItemIcon,
            ListItemText,
            makeStyles,
            MenuItem,
            MenuProps,
            Paper,
            Select,
            SvgIcon,
            TextField,
            ThemeProvider,
            Tooltip,
            Typography,
            useTheme,
        } = MaterialUI;

        // Create a MUI theme instance.
        const theme = createMuiTheme({
            palette: {
                primary: {
                    main: '#556cd6',
                },
                secondary: {
                    main: '#19857b',
                },
                error: {
                    main: colors.red.A400,
                },
                background: {
                    default: '#f5f5f5',
                },
            },
        });

        // Create styles/classes.
        const useStyles = makeStyles(theme => ({
            htmlBody: {
                background: "#f5f5f5",
            },
            root: {
                margin: theme.spacing(6, 0, 3),
            },
            mainContainer: {
                margin: "20px",
                padding: "20px"
            },
            sideContainer: {
                margin: "20px",
                padding: "10px"
            },
            formControl: {
                margin: theme.spacing(1),
                minWidth: 240,
                maxWidth: 240,
            },
            chips: {
                display: 'flex',
                flexWrap: 'wrap',
            },
            chip: {
                margin: 2,
            },
            chosenCountry: {
                color: theme.palette.primary.main,
                background: "blue",
            },
            normalCountry: {

            },
            formTitle: {
                color: theme.palette.primary.main,
            },
            formControlOutlined: {
                margin: theme.spacing(1),
                minWidth: 240,
                maxWidth: 240,
                border: "1px solid lightGray",
                borderRadius: "4px",
                color: "lightGray"
            },
            formControlOutlinedError:{
                margin: theme.spacing(1),
                minWidth: 240,
                maxWidth: 240,
                border: "1px solid red",
                borderRadius: "4px",
                color: "red"
            },
            filesControlOutlined: {
                margin: theme.spacing(1),
                minWidth: 240,
                maxWidth: 240,
                border: "1px solid lightGray",
                borderRadius: "4px",
                paddingLeft: "10px",
                paddingTop: "10px",
                fontSize: "1rem",
                fontFamily: "'Roboto', 'Helvetica', 'Arial', sans-serif",
                color: "rgba(0, 0, 0, 0.54)",

            },
            filesButton: {
                display: "none",
            },
            filesLabel: {
                display: "inline-block",
                padding: "6px 12px",
                cursor: "pointer",
                color: "rgba(0, 0, 0, 0.54)",
                fontSize: "1rem",
                fontFamily: "'Roboto', 'Helvetica', 'Arial', sans-serif",
                fontWeight: "400",
                lineHeight: "1",
                letterSpacing: "0.00938em",
            },
            files: {
                border: "none 0px",
            },
            icon: {
                marginRight: theme.spacing.unit,
            },
            timestamp: {
                color: theme.palette.primary.main,
                textDecoration: "underline",
                cursor: "pointer",
                '&:hover': {
                    color: "#5657D6",
                    fontWeight: "bold",
                }
            },
            territoriesSelect: {
                background: "white",
            },
            territoriesDeleteIcon: {
                cursor: "pointer",
                marginLeft: theme.spacing(22),
                '&:hover': {
                    color: "#5657D6",
                }
            }
        }));
        /* ----- END: MUI Setup ----- */

        /* ----- BEGIN: CSV Helpers ----- */
        const fields = {
            filename: { name: "Filename", type: "", default_value: "" },
            title: { name: "Title", type: "", default_value: "" },
            territories: { name: "Territories", type: "", default_value: "" },
            description: { name: "Description", type: "", default_value: "" },
            category: { name: "Category", type: "", default_value: "" },
            monitoring_type: { name: "Monitoring Type", type: "", default_value: "" },
            match_rule_id: { name: "Match Rule ID", type: "", default_value: "" },
            reference_disabled: { name: "Reference Disabled", type: "", default_value: "" },
            whitelisted_fb_ids: { name: "Whitelisted FB IDs", type: "", default_value: "" },
            whitelisted_ig_ids: { name: "Whitelisted IG IDs", type: "", default_value: "" },
            tags: { name: "Tags", type: "", default_value: "" },
            action: { name: "Action", type: "", default_value: "CREATE" }
        }

        const processFormField = (_field) => {
            let field = document.getElementById(_field);
            if (field !== null) {
                return field.value
            }
            return fields[_field].default_value;
        }

        const getVideoTitle = (video) => {
            const index = video.lastIndexOf(".");
            const title = video.substring(0, index);
            let str = title.toLowerCase().split(' ');
            for (var i = 0; i < str.length; i++) {
                str[i] = str[i].charAt(0).toUpperCase() + str[i].slice(1);
            }
            return str.join(' ');
        }

        const generateCSVContent = () => {
            console.log("Generating CSV content");
            let values = {};
            let csvContent = "";

            for (const f in fields) {
                values[f] = processFormField(f);
                csvContent += fields[f].name + ",";
            }
            csvContent += "\n";
            var videos = document.getElementById("video_files");
            for (let i = 0; i < videos.files.length; i++) {
                let file = videos.files[i];
                values.filename = file.name;
                values.title = getVideoTitle(file.name);
                for (const f in values) {
                    csvContent += "\"" + values[f] + "\",";
                }
                csvContent += "\n";
            }
            console.log("CSV content: \n", csvContent);
            return csvContent;
        }

        const exportFile = (csvContent) => {
            console.log("Exporting CSV file");
            let filename = "csv_file.csv";
            var blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            if (navigator.msSaveBlob) { // IE 10+
                navigator.msSaveBlob(blob, filename);
            } else {
                var link = document.createElement("a");
                if (link.download !== undefined) { // feature detection
                    // Browsers that support HTML5 download attribute
                    var url = URL.createObjectURL(blob);
                    link.setAttribute("href", url);
                    link.setAttribute("download", filename);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
            }
            console.log("CSV file exported as ", filename);
        }

        const generateCSVFile = () => {
            const csvContent = generateCSVContent();
            exportFile(csvContent);
            alert("Opening the generated CSV with a Spreadsheet editor may modify its format. Make sure to validate the file before uploading it.");
        }

        const handleChange = (event) => {
            let event_id = event.target.name;
            document.getElementById(event_id).value = event.target.value;
        };

        const validate = () => {
            const value = document.getElementById("video_files").value
            if (value === null || value === "" || value === undefined || value.length === 0) {
                setError(true);
                setHelperText("You must select at least 1 video file");
            } else {
                setError(false);
                setHelperText("")
            }
        }

        const getTimestamp = () => {
            return Date.now()
        }

        /* ----- END: CSV Helpers ----- */

        /* ----- BEGIN: Form Components ----- */

        function Heading() {
            const classes = useStyles();
            return (
                <Typography variant="h4" className={classes.formTitle} gutterBottom>
                    RMSI - CSV Generator
                </Typography>
            )
        }

        function Files() {
            const classes = useStyles();
            const [filesCount, setFilesCount] = React.useState(0);
            const [error, setError] = React.useState(false);
            const [helperText, setHelperText] = React.useState("");

            const validate = () => {
                const value = document.getElementById("video_files").value
                if (value === null || value === "" || value === undefined || value.length === 0) {
                    setError(true);
                    setHelperText("You must select at least 1 video file");
                } else {
                    setError(false);
                    setHelperText("")
                }
            }

            const onChangeFiles = () => {
                var videos = document.getElementById("video_files");
                setFilesCount(videos.files.length)
                validate()
            }

            return (
                <FormControl variant="outlined" className={classes.filesControlOutlined}>
                    Videos *: {filesCount} files selected
                    <br />
                    <label for="video_files" className={classes.filesLabel} onBlur={validate}>
                        <font className="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary">Select </font>
                    </label>
                    <input
                        type="file"
                        name="video_files"
                        id="video_files"
                        multiple
                        required
                        accept=".3g2,.3gp,.3gpp,.asf,.avi,.dat,.divx,.dv,.f4v,.flv,.gif,.m2ts,.m4v,.mkv,.mod,.mov,.mp4,.mpe,.mpeg,.mpeg4,.mpg,.mts,.nsv,.ogm,.ogv,.qt,.tod,.ts,.vob,.wmv"
                        className={classes.filesButton}
                        onChange={onChangeFiles}
                        onBlur={validate} />
                    <FormHelperText>{helperText}</FormHelperText>
                </FormControl>
            )
        }

        function Territories() {
            const classes = useStyles();
            const [territoryName, setTerritoryName] = React.useState([]);
            const [countries, setCountries] = React.useState({});
            const [error, setError] = React.useState(false);
            const [helperText, setHelperText] = React.useState("");

            React.useEffect(() => {
                async function getCountries() {
                    const response = await fetch('https://raw.githubusercontent.com/juanjoms-fb/rm-singestion/main/Territories%20ISO%20Alpha%202.csv')
                    const reader = response.body.getReader()
                    const result = await reader.read() // raw array
                    const decoder = new TextDecoder('utf-8')
                    const csv = decoder.decode(result.value) // the csv text
                    const results = Papa.parse(csv, { header: false }) // object with { data, errors, meta }
                    const rows = results.data // array of objects
                    let c = {}
                    rows.forEach(e => {
                        c[e[0]] = e[1];
                    })
                    setCountries(c)
                }
                getCountries()
            }, []) // [] means just do this once, after initial render

            const getClassName = (country) => {
                return (
                    territoryName.indexOf(country) === -1
                        ? classes.normalCountry
                        : classes.chosenCountry
                );
            }

            const validate = () => {
                const value = document.getElementById("territories").value
                if (value === null || value === "" || value === undefined || value.length === 0) {
                    setError(true);
                    setHelperText("You must select at least 1 territory");
                } else {
                    setError(false);
                    setHelperText("")
                }
            }

            const handleChangeTerritories = (event) => {
                let newTerritories = event.target.value;
                if (newTerritories.includes("WW")) {
                    newTerritories = ["WW"]
                }
                if (newTerritories.length === 0 || newTerritories === undefined) {
                    setError(true);
                    setHelperText("You must select at least 1 territory");
                }
                setTerritoryName(newTerritories);
                document.getElementById("territories").value = newTerritories;
                validate();
            };

            const populateCountryList = () => {
                let countryEntries = []
                for (const country in countries) {
                    countryEntries.push(
                        <MenuItem key={country} value={country}
                            className={getClassName(country)}>
                            {countries[country]}
                        </MenuItem>
                    );
                }
                return countryEntries;
            }

            const clean = () => {
                let e={
                    target:{
                        value:[]
                    }
                };
                handleChangeTerritories(e);
            }

            const formControlClass = ()=>{
                return (
                    error ?
                    classes.formControlOutlinedError:
                    classes.formControlOutlined
                )
            }

            return (
                <FormControl variant="outlined"
                className={formControlClass()}
                //className={classes.formControlOutlinedError}
                >
                    <InputLabel id="territories-label">Territories *</InputLabel>
                    <Select
                        labelId="territories-label"
                        multiple
                        required
                        disableUnderline
                        className={classes.territoriesSelect}
                        error={error}
                        value={territoryName}
                        onChange={handleChangeTerritories}
                        onBlur={validate}
                        input={<Input id="select-multiple-chip" />}
                        renderValue={(selected) => (
                            <div className={classes.chips}>
                                {selected.map((value) => (
                                    <Chip key={value} label={value} className={classes.chip} />
                                ))}
                            </div>
                        )}
                        MenuProps={MenuProps}
                    >
                        {populateCountryList()}
                    </Select>
                    {
                        territoryName.length>0?
                        <Container fixed>
                                <Icon className={classes.territoriesDeleteIcon} onClick={clean}>delete</Icon>
                        </Container>
                        :
                        <></>
                    }
                    <FormHelperText>{helperText}</FormHelperText>
                    <input type="hidden" id="territories" name="territories" />
                </FormControl>
            )
        }

        function Category() {
            const classes = useStyles();
            const [error, setError] = React.useState(false);
            const [helperText, setHelperText] = React.useState("");

            const CATEGORY = {
                EPISODE: "Episode",
                MOVIE: "Movie",
                WEB: "Web",
            }

            const populateCategoriesList = () => {
                let categories = []
                for (const category_key in CATEGORY) {
                    categories.push(<MenuItem value={category_key}>{CATEGORY[category_key]}</MenuItem>)
                }
                return categories;
            }

            const validate = () => {
                const value = document.getElementById("category").value
                if (value === null || value === "" || value === undefined) {
                    setError(true);
                    setHelperText("You must select a category");
                } else {
                    setError(false);
                    setHelperText("")
                }
            }

            const handleChange = (event) => {
                let event_id = event.target.name;
                document.getElementById(event_id).value = event.target.value;
                validate();
            };

            return (
                <FormControl variant="outlined" className={classes.formControl}>
                    <InputLabel id="category-label">Category *</InputLabel>
                    <Select
                        labelId="category-label"
                        id="category"
                        name="category"
                        required
                        error={error}
                        onChange={handleChange}
                        onBlur={validate}
                    >
                        {populateCategoriesList()}
                    </Select>
                    <FormHelperText>{helperText}</FormHelperText>
                </FormControl>
            )
        }

        function MonitoringType() {
            const classes = useStyles();
            const [error, setError] = React.useState(false);
            const [helperText, setHelperText] = React.useState("");

            const MONITORING_TYPE = {
                VIDEO_AND_AUDIO: "Video and audio",
                VIDEO_ONLY: "Video only",
                AUDIO_ONLY: "Audio only",
            }

            const populateTypeList = () => {
                let monitoring_types = []
                for (const mtype in MONITORING_TYPE) {
                    monitoring_types.push(<MenuItem value={mtype}>{MONITORING_TYPE[mtype]}</MenuItem>)
                }
                return monitoring_types;
            }

            const validate = () => {
                const value = document.getElementById("monitoring_type").value
                if (value === null || value === "" || value === undefined) {
                    setError(true);
                    setHelperText("You must select a type");
                } else {
                    setError(false);
                    setHelperText("")
                }
            }

            const handleChange = (event) => {
                let event_id = event.target.name;
                document.getElementById(event_id).value = event.target.value;
                validate();
            };

            return (
                <FormControl variant="outlined" className={classes.formControl}>
                    <InputLabel id="monitoring-type-label">Monitoring Type *</InputLabel>
                    <Select
                        labelId="monitoring-type-label"
                        id="monitoring_type"
                        name="monitoring_type"
                        required
                        error={error}
                        onChange={handleChange}
                        onBlur={validate}
                    >
                        {populateTypeList()}
                    </Select>
                    <FormHelperText>{helperText}</FormHelperText>
                </FormControl>
            )
        }

        function ReferenceDisabled() {
            const classes = useStyles();
            const [checked, setChecked] = React.useState(false);

            const handleChange = (event) => {
                setChecked(event.target.checked);
                document.getElementById("reference_disabled").value = event.target.checked;
            };

            return (
                <FormControl className={classes.formControl}>
                    <FormControlLabel
                        control={
                            <Checkbox
                                color="primary"
                                checked={checked}
                                onChange={handleChange}
                            />
                        }
                        label="Reference Disabled"
                    />
                    <input type="hidden" id="reference_disabled" name="reference_disabled" value="false" />
                </FormControl>
            )
        }

        function MatchRuleId() {
            const classes = useStyles();
            const [error, setError] = React.useState(false);
            const [helperText, setHelperText] = React.useState("");

            const validate = () => {
                const value = document.getElementById("match_rule_id").value
                var reg = new RegExp('^\\d+$');
                if (value === null || value === "" || value === undefined || value.length === 0 ||
                    !reg.test(value)
                ) {
                    setError(true);
                    setHelperText("Rule id must numeric");
                } else {
                    setError(false);
                    setHelperText("")
                }
            }

            return (
                <FormControl className={classes.formControl}>
                    <TextField
                        id="match_rule_id"
                        name="match_rule_id"
                        label="Match Rule Id"
                        variant="outlined"
                        error={error}
                        helperText={helperText}
                        onBlur={validate}
                        onChange={validate}
                        required />
                </FormControl>
            )
        }

        function AllowedFBIds() {
            const classes = useStyles();
            const defaultHelperText = "id1,id2,..."
            const [error, setError] = React.useState(false);
            const [helperText, setHelperText] = React.useState(defaultHelperText);

            const validate = () => {
                const value = document.getElementById("whitelisted_fb_ids").value
                var reg = new RegExp("^(?:[0-9]+,)*[0-9]+(?:\.[0-9]+)?$");
                if (value !== "" && !reg.test(value)) {
                    setError(true);
                    setHelperText("Numeric ids separated by comma");
                } else {
                    setError(false);
                    setHelperText(defaultHelperText)
                }
            }

            return (
                <FormControl className={classes.formControl}>
                    <TextField
                        id="whitelisted_fb_ids"
                        name="whitelisted_fb_ids"
                        label="Allowed FB ids"
                        variant="outlined"
                        defaultValue=""
                        multiline
                        rows={3}
                        error={error}
                        helperText={helperText}
                        onChange={validate}
                        onBlur={validate}
                    />
                </FormControl>
            )
        }

        function AllowedIGIds() {
            const classes = useStyles();
            const defaultHelperText = "id1,id2,..."
            const [error, setError] = React.useState(false);
            const [helperText, setHelperText] = React.useState(defaultHelperText);

            const validate = () => {
                const value = document.getElementById("whitelisted_ig_ids").value
                var reg = new RegExp("^(?:[0-9]+,)*[0-9]+(?:\.[0-9]+)?$");
                if (value !== "" && !reg.test(value)) {
                    setError(true);
                    setHelperText("Numeric ids separated by comma");
                } else {
                    setError(false);
                    setHelperText(defaultHelperText)
                }
            }

            return (
                <FormControl className={classes.formControl}>
                    <TextField
                        id="whitelisted_ig_ids"
                        name="whitelisted_ig_ids"
                        label="Allowed IG ids"
                        variant="outlined"
                        defaultValue=""
                        multiline
                        rows={3}
                        error={error}
                        helperText={helperText}
                        onChange={validate}
                        onBlur={validate}
                    />
                </FormControl>
            )
        }

        function Tags() {
            const classes = useStyles();
            const defaultHelperText = "tag 1,tag 2,..."
            const [error, setError] = React.useState(false);
            const [helperText, setHelperText] = React.useState(defaultHelperText);

            const validate = () => {
                const value = document.getElementById("tags").value
                var reg = new RegExp("^(?:[a-zA-Z0-9_ ]+,)*[a-zA-Z0-9_ ]+(?:\.[a-zA-Z0-9_ ]+)?$");
                if (value !== "" && !reg.test(value)) {
                    setError(true);
                    setHelperText("Numeric ids separated by comma");
                } else {
                    setError(false);
                    setHelperText(defaultHelperText)
                }
            }

            return (
                <FormControl className={classes.formControl}>
                    <TextField
                        id="tags"
                        name="tags"
                        label="Tags"
                        variant="outlined"
                        multiline
                        rows={3}
                        defaultValue=""
                        error={error}
                        helperText={helperText}
                        onChange={validate}
                        onBlur={validate}
                    />
                </FormControl>
            )
        }

        function Description() {
            const classes = useStyles();
            const defaultHelperText = "Description for all files";
            const [error, setError] = React.useState(false);
            const [helperText, setHelperText] = React.useState(defaultHelperText);

            const validate = () => {
                setError(false);
            }

            return (
                <FormControl className={classes.formControl}>
                    <TextField
                        id="description"
                        label="Description"
                        multiline
                        rows={3}
                        defaultValue="Files uploaded via RMSI"
                        variant="outlined"
                        error={error}
                        helperText={helperText}
                        onChange={validate}
                        onBlur={validate}
                    />
                </FormControl>
            )
        }

        function CSVForm() {
            const classes = useStyles();

            return (
                <Paper elevation={3}>
                    <Grid
                        container
                        direction="column"
                        justify="center"
                        alignItems="center"
                        className={classes.mainContainer}>
                        <Grid item xs>
                            <Heading />
                        </Grid>
                        <Grid item xs>
                            <Files />
                        </Grid>
                        <Grid item xs>
                            <Territories />
                        </Grid>
                        <Grid item xs>
                            <Category />
                        </Grid>
                        <Grid item xs>
                            <MonitoringType />
                        </Grid>
                        <Grid item xs>
                            <MatchRuleId />
                        </Grid>
                        <Grid item xs>
                            <ReferenceDisabled />
                        </Grid>
                        <Grid item xs>
                            <AllowedFBIds />
                        </Grid>
                        <Grid item xs>
                            <AllowedIGIds />
                        </Grid>
                        <Grid item xs>
                            <Tags />
                        </Grid>
                        <Grid item xs>
                            <Description />
                        </Grid>
                        <Grid item xs>
                            <Button variant="contained" color="primary" onClick={generateCSVFile}>
                                Export CSV
                                </Button>
                        </Grid>
                    </Grid>
                </Paper>
            )
        }

        function ListItemLink(props) {
            return <ListItem button component="a" {...props} />;
        }

        function Instructions() {
            const classes = useStyles();
            const [currentTimestamp, setCurrentTimestamp] = React.useState(getTimestamp())
            const [open, setOpen] = React.useState(false);
            const [tooltipText, setTooltipText] = React.useState("");

            const handleTooltipClose = () => {
                setOpen(false);
            };

            const handleTimestampClick = () => {
                let ts = getTimestamp();
                setCurrentTimestamp(ts);
                const el = document.createElement('textarea');
                el.value = ts;
                document.body.appendChild(el);
                el.select();
                document.execCommand('copy');
                document.body.removeChild(el);
                console.log("Copied the text: " + ts);
                setTooltipText("Copied " + ts)
                setOpen(true);
            }

            return (
                <Paper
                    className={classes.sideContainer}
                    elevation={3}>
                    <Container>
                        <Typography variant="h6" className={classes.formTitle} gutterBottom>
                            Instructions
                    </Typography>
                    </Container>
                    <div>
                        <List dense={true}>
                            <ListItem>
                                <ListItemText
                                    primary={
                                        <React.Fragment>
                                            <b>1.</b> If you haven't done it yet, create a <b>match rule id</b> in <a href="https://business.facebook.com/creatorstudio?tab=rights_manager_match_rules">Creator Studio</a>.
                                        </React.Fragment>
                                    }
                                />
                            </ListItem>
                            <ListItem>
                                <ListItemText
                                    primary={
                                        <React.Fragment>
                                            <b>2.</b> Create a <b>new directory</b> and name it with the current UNIX timestamp (
                                            <span
                                                onClick={handleTimestampClick}
                                                className={classes.timestamp}
                                                id="timestamp"
                                            >
                                                <Tooltip
                                                    PopperProps={{
                                                        disablePortal: true,
                                                    }}
                                                    onClose={handleTooltipClose}
                                                    open={open}
                                                    title={tooltipText}
                                                >
                                                    <i>{currentTimestamp}</i>
                                                </Tooltip>
                                            </span>
                                            ). Place all your videos here.
                                        </React.Fragment>
                                    }
                                />
                            </ListItem>
                            <ListItem>
                                <ListItemText
                                    primary={
                                        <React.Fragment>
                                            <b>3.</b> <b>Fill this form:</b>.
                                            <br /> - Select the <b>videos</b> to be included in the CSV.
                                            <br /> - Indicate the <b>territories</b> where they will be protected, the <b>category</b> of the videos, the type of <b>monitoring</b> and the <b>match rule</b> id from step 1.
                                            <br /> - Optionally you can provide FB and/or IG <b>ids</b> that are allowed to use your videos, and <b>tags</b> for your videos.
                                            <br /> - Add a <b>description</b> to be applied for your videos
                                            <br /> - Click the <b>"Export CSV"</b> button and wait for your file to be downloaded.
                                        </React.Fragment>
                                    }
                                />
                            </ListItem>
                            <ListItem>
                                <ListItemText
                                    primary={
                                        <React.Fragment>
                                            <b>4.</b> <a href="https://developers.facebook.com/docs/rights-manager-video/csv-validator">Validate</a> your CSV file.
                                        </React.Fragment>
                                    }
                                />
                            </ListItem>
                            <ListItem>
                                <ListItemText
                                    primary={
                                        <React.Fragment>
                                            <b>5.</b> <b>Upload your files:</b> Start with the <b>videos</b> and wait for all of them to be completely uploaded. Then proceed with the <b>CSV file</b> and after it is transferred upload the <b>completion manifest</b>.
                                        </React.Fragment>
                                    }
                                />
                            </ListItem>
                        </List>
                    </div>
                </Paper>
            )
        }

        function UsefulLinks() {
            const classes = useStyles();

            return (
                <Paper
                    className={classes.sideContainer}
                    elevation={3}>
                    <Container>
                        <Typography variant="h6" className={classes.formTitle} gutterBottom>
                            Useful links
                    </Typography>
                    </Container>
                    <List component="nav" aria-label="main mailbox folders">
                        <ListItemLink href="https://github.com/juanjoms-fb/rm-singestion/raw/main/RMSI%20Documentation.pdf">
                            <ListItemIcon>
                                <Icon className={classes.icon}>article</Icon>
                            </ListItemIcon>
                            <ListItemText primary="Documentation" />
                        </ListItemLink>
                        <ListItemLink href="mailto:oncall+rights_manager_scaled_ingestion@xmail.facebook.com">
                            <ListItemIcon>
                                <Icon className={classes.icon}>alternate_email</Icon>
                            </ListItemIcon>
                            <ListItemText primary="Support" />
                        </ListItemLink>
                        <ListItemLink href="https://www.ssh.com/ssh/keygen/">
                            <ListItemIcon>
                                <Icon className={classes.icon}>vpn_key</Icon>
                            </ListItemIcon>
                            <ListItemText primary="Generate Keys" />
                        </ListItemLink>
                        <ListItemLink href="https://developers.facebook.com/docs/rights-manager-video/csv-validator">
                            <ListItemIcon>
                                <Icon className={classes.icon}>done</Icon>
                            </ListItemIcon>
                            <ListItemText primary="CSV Validator" />
                        </ListItemLink>
                    </List>
                </Paper>
            )
        }
        /* ----- END: Form Components ----- */

        /* ----- BEGIN: React Main App ----- */
        function App() {
            const classes = useStyles();
            return (
                <Container className={classes.htmlBody}>
                    <Grid container spacing={1}>
                        <Grid item xs={12} sm={8}>
                            <CSVForm />
                        </Grid>
                        <Grid item xs={12} sm={4}>
                            <Grid container direction="column" spacing={1}>
                                <Grid item xs={12} sm={12} >
                                    <Instructions />
                                </Grid>
                                <Grid item xs={12} sm={12}>
                                    <UsefulLinks />
                                </Grid>
                            </Grid>
                        </Grid>
                    </Grid>
                </Container>
            );
        }

        ReactDOM.render(
            <ThemeProvider theme={theme}>
                <CssBaseline />
                <App />
            </ThemeProvider>,
            document.querySelector('#root'),
        );

        /* ----- END: React Main App ----- */

    </script>

</body>

</html>
